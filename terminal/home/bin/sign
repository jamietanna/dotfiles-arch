#!/usr/bin/env ruby
require 'jwt'

payload = JSON.parse(File.read ARGV[0])
maybe_secret = ARGV[1]
algorithm = ARGV[2] || 'HS256'

if File.exists? maybe_secret
  maybe_secret = OpenSSL::PKey.read(File.read maybe_secret)
end

puts JWT.encode payload, maybe_secret, algorithm
